/*!
 * TutorJS - smart tutorials for site users
 * @version  v1.1
 * @author   Evgenii Dulikov
 * http://datatables.net/license_gpl2
 * Copyright 2014 Evgenii Dulikov <gerrproger@gmail.com>
 * https://github.com/Gerrproger/TutorJS
 */
!function(){"use strict";window.tutorJS={VERSION:1.1,canva:null,hole:null,bg:null,hint:null,text:null,wrap:null,bNext:null,bQuit:null,tNext:null,tQuit:null,tCount:null,nAll:null,nCurr:null,inited:!1,active:null,elements:null,auto:null,onQuit:null,nodes:[],htmlOv:null,bodyOv:null,html:null,butW:80,butH:34,t:300,pad:10,shif:10,lineL:30,lineH:20,ID:function(t){return document.getElementById(t)},CLASS:function(t){return document.getElementsByClassName(t)},TAG:function(t){return document.getElementsByTagName(t)},EL:function(t){return document.querySelector(t)},ELS:function(t){return document.querySelectorAll(t)},anim:function(t,e,n){var o=this,i=o.create("animate"),r={};return o.attr(i,{attributeName:e.attr,to:e.to,dur:e.dur/1e3+"s",fill:"freeze",keySplines:"0.42 0 0.58 1",calcMode:"spline"}),t.appendChild(i),i.beginElement&&i.beginElement(),r[e.attr]=e.to,setTimeout(function(){o.attr(t,r),t.removeChild(i),"function"==typeof n&&n(t)},e.dur),{and:function(e,n){return o.anim(t,e,n)},anim:function(t,e,n){return o.anim(t,e,n)}}},attr:function(t,e){for(var n in e)t.setAttributeNS(null,n,e[n]);return this},on:function(t,e,n){var o=this;return t.addEventListener(e,function(e){n(e,t,o)},!1),{on:function(e,n){return o.on(t,e,n)}}},create:function(t,e){return e?document.createTextNode(t):document.createElementNS("http://www.w3.org/2000/svg",t)},offset:function(t){return t.getBoundingClientRect()},width:function(t){return t.offsetWidth},height:function(t){return t.offsetHeight},positionTop:function(t){for(var e=0;t;)e+=parseFloat(t.offsetTop),t=t.offsetParent;return e},scrolledTop:function(){return document.documentElement.scrollTop||document.body.scrollTop||0},isInView:function(t){var e=this,n=e.positionTop(t),o=n+e.height(t),i=e.scrolledTop(),r=i+document.documentElement.clientHeight;return r>=o&&n>=i},go:function(t){var e=this,n=e.offset(t),o=e.width(t),i=e.height(t);if(!(o||i||n.left||n.top))throw new Error("This element is hidden! ["+(e.active+1)+"]("+e.elements[e.active].element+")");return e.anim(e.hole,{attr:"width",to:o,dur:e.t}).and({attr:"height",to:i,dur:e.t}).and({attr:"x",to:n.left,dur:e.t}).and({attr:"y",to:n.top,dur:e.t}),n.w=o,n.h=i,n},texter:function(t,e,n){var o=this,i=Math.round(o.t/3),r=1,u=!1,l=[],a=0,d=null,h=null,c=null,s=null;for(c=0,s=t.length;s>c;c++)c+1>o.lineL*r&&(u=!0,r++),u&&" "==t[c]&&(l.push(t.substring(a,c+1)),a=c+1,u=!1);return l.length?a<t.length&&l.push(t.substring(a,t.length)):l.push(t),o.nodes.length&&o.anim(o.hint,{attr:"opacity",to:0,dur:i},function(){for(var t=0,e=o.nodes.length;e>t;t++)o.text.removeChild(o.nodes[t]);o.nodes.length=0}),setTimeout(function(){for(o.nCurr&&o.tCount.removeChild(o.nCurr),o.nCurr=o.create(o.active,!0),o.tCount.insertBefore(o.nCurr,o.nAll),c=0,s=l.length;s>c;c++){var t=o.create("tspan"),i=o.create(l[c],!0);o.attr(t,{x:0}),0==c?o.attr(t,{dy:o.pad}):o.attr(t,{dy:o.lineH}),t.appendChild(i),o.text.appendChild(t),o.nodes.push(t)}var r=o.text.getBBox(),u=o.tCount.getBBox(),a=o.tNext.getBBox(),f=o.tQuit.getBBox(),p=2*o.butW+u.width+2*o.pad;if(r.width<p){var m={width:p,height:r.height,x:r.x,y:r.y};r=m}switch(n){case"top":d=e.left+o.pad,h=e.top-r.height-o.shif-o.pad-o.butH;break;case"left":d=e.left-r.width-o.shif-o.pad,h=e.top+o.pad;break;case"right":d=e.left+e.w+o.shif+o.pad,h=e.top+o.pad;break;default:d=e.left+o.pad,h=e.top+e.h+o.shif+o.pad}for(c=0;s>c;c++)o.attr(o.nodes[c],{x:d});o.attr(o.text,{x:d,y:h}).attr(o.wrap,{x:d-o.pad,y:h-o.pad,height:r.height+2*o.pad+o.butH,width:r.width+2*o.pad}).attr(o.bNext,{x:d+r.width+o.pad-o.butW,y:h+r.height+o.pad}).attr(o.tNext,{x:d+o.pad/2+Math.round(r.width-(o.butW+a.width)/2),y:h+r.height+2*o.pad+Math.round((o.butH-1.2*a.height)/2)}).attr(o.bQuit,{x:d,y:h+r.height+o.pad}).attr(o.tQuit,{x:d-o.pad/2+Math.round((o.butW-f.width)/2),y:h+r.height+2*o.pad+Math.round((o.butH-1.2*f.height)/2)}).attr(o.tCount,{x:d+Math.round((r.width-u.width)/2),y:h+r.height+o.pad+o.butH/2}).anim(o.hint,{attr:"opacity",to:1,dur:o.t})},o.t),o},next:function(t){var e=this;if("re"!=t||e.auto){if(!e.elements||!e.elements[e.active])return e.active>0&&e.quit(),e;t&&"re"!=t&&(e.auto=t);var n=e.elements[e.active].element;if("string"==typeof n&&(n=e.ID(n)),!(n instanceof HTMLElement))throw new Error("No such element on this page! ["+(e.active+1)+"]("+e.elements[e.active].element+")");e.isInView(n)||window.scrollTo(0,e.positionTop(n)-e.pad),"function"==typeof e.elements[e.active].onActive&&e.elements[e.active].onActive(n,e.active+1);var o=e.go(n);return e.texter(e.elements[e.active].caption,o,e.elements[e.active].position).active++,e.auto&&setTimeout(function(){e.next("re")},e.auto),e}},stop:function(){var t=this;return t.auto=null,t},start:function(t,e){var n=this;return n.active=0,"object"==typeof e&&(n.auto=e.auto,n.onQuit=e.onQuit),n.elements=t.length?t:[t],n.inited?n.nAll&&(n.tCount.removeChild(n.nAll),n.nAll=null):(n.canva=n.ID("tutorJS-svg"),n.hole=n.ID("tutorJS-hole"),n.bg=n.ID("tutorJS-bg"),n.text=n.ID("tutorJS-text"),n.wrap=n.ID("tutorJS-wrap"),n.bNext=n.ID("tutorJS-nextW"),n.bQuit=n.ID("tutorJS-quitW"),n.tNext=n.ID("tutorJS-nextT"),n.tQuit=n.ID("tutorJS-quitT"),n.tCount=n.ID("tutorJS-count"),n.hint=n.ID("tutorJS-hint"),n.html=n.EL("html"),n.htmlOv=n.html.style.overflow,n.bodyOv=document.body.style.overflow,n.on(n.ID("tutorJS-next"),"click",function(){n.next(),n.attr(n.bNext,{fill:"url(#tutorJS-gradient3)"})}).on("mouseover",function(){n.attr(n.bNext,{fill:"url(#tutorJS-gradient5)"})}).on("mouseout",function(){n.attr(n.bNext,{fill:"url(#tutorJS-gradient3)"})}),n.on(n.ID("tutorJS-quit"),"click",function(){n.quit()}).on("mouseover",function(){n.attr(n.bQuit,{fill:"url(#tutorJS-gradient6)"})}).on("mouseout",function(){n.attr(n.bQuit,{fill:"url(#tutorJS-gradient4)"})}),n.inited=!0),n.html.style.overflow=document.body.overflow="hidden",n.nAll=n.create("/"+n.elements.length,!0),n.tCount.appendChild(n.nAll),n.canva.style.display="block",n.anim(n.bg,{attr:"opacity",to:1,dur:3*n.t},function(){n.next()}),n},quit:function(){var t=this;return t.stop(),t.anim(t.hole,{attr:"opacity",to:0,dur:t.t}).anim(t.hint,{attr:"opacity",to:0,dur:t.t}).anim(t.bg,{attr:"opacity",to:0,dur:3*t.t},function(){t.html.style.overflow=t.htmlOv,document.body.style.overflow=t.bodyOv,t.canva.style.display="none",t.attr(t.hole,{width:0,height:0,x:0,y:0,opacity:1}),"function"==typeof t.onQuit&&t.onQuit(t)}),t}}}();