/*!
 * TutorJS - smart tutorials for site users
 * @version  v1.0
 * @author   Evgenii Dulikov
 * http://datatables.net/license_gpl2
 * Copyright 2014 Evgenii Dulikov <gerrproger@gmail.com>
 * https://github.com/Gerrproger/TutorJS
 */
 !function(){window.tutorJS={VERSION:1,canva:null,hole:null,bg:null,hint:null,text:null,wrap:null,bNext:null,bQuit:null,tNext:null,tQuit:null,tCount:null,nAll:null,nCurr:null,inited:!1,active:null,elements:null,auto:null,onQuit:null,nodes:[],butW:80,butH:34,t:300,pad:10,shif:10,lineL:30,lineH:20,ID:function(t){return document.getElementById(t)},CLASS:function(t){return document.getElementsByClassName(t)},TAG:function(t){return document.getElementsByTagName(t)},anim:function(t,e,n){var i=this,o=i.create("animate"),u={};return i.attr(o,{attributeName:e.attr,to:e.to,dur:e.dur/1e3+"s",fill:"freeze",keySplines:"0.42 0 0.58 1",calcMode:"spline"}),t.appendChild(o),o.beginElement(),u[e.attr]=e.to,setTimeout(function(){i.attr(t,u),t.removeChild(o),"function"==typeof n&&n(t)},e.dur),{and:function(e,n){return i.anim(t,e,n)},anim:function(t,e,n){return i.anim(t,e,n)}}},attr:function(t,e){for(var n in e)t.setAttribute(n,e[n]);return this},on:function(t,e,n){var i=this;return t.addEventListener(e,function(e){n(e,t,i)},!1),{on:function(e,n){return i.on(t,e,n)}}},create:function(t,e){return e?document.createTextNode(t):document.createElementNS("http://www.w3.org/2000/svg",t)},offset:function(t){for(var e=0,n=0;t;)e+=parseFloat(t.offsetTop),n+=parseFloat(t.offsetLeft),t=t.offsetParent;return{top:Math.round(e),left:Math.round(n)}},width:function(t){return t.offsetWidth},height:function(t){return t.offsetHeight},go:function(t){var e=this;if("string"==typeof t&&(t=e.ID(t)),!(t instanceof HTMLElement))throw new Error("No such element on this page! ["+(e.active+1)+"]("+e.elements[e.active].element+")");var n=e.offset(t),i=e.width(t),o=e.height(t);if(!(i||o||n.left||n.top))throw new Error("This element is hidden! ["+(e.active+1)+"]("+e.elements[e.active].element+")");return e.anim(e.hole,{attr:"width",to:i,dur:e.t}).and({attr:"height",to:o,dur:e.t}).and({attr:"x",to:n.left,dur:e.t}).and({attr:"y",to:n.top,dur:e.t}),n.w=i,n.h=o,n},texter:function(t,e,n){var i=this,o=Math.round(i.t/3),u=1,r=!1,a=[],l=0,h=null,d=null,c=null,s=null;for(c=0,s=t.length;s>c;c++)c+1>i.lineL*u&&(r=!0,u++),r&&" "==t[c]&&(a.push(t.substring(l,c+1)),l=c+1,r=!1);return a.length?l<t.length&&a.push(t.substring(l,t.length)):a.push(t),i.nodes.length&&i.anim(i.hint,{attr:"opacity",to:0,dur:o},function(){for(var t=0,e=i.nodes.length;e>t;t++)i.text.removeChild(i.nodes[t]);i.nodes.length=0}),setTimeout(function(){for(i.nCurr&&i.tCount.removeChild(i.nCurr),i.nCurr=i.create(i.active,!0),i.tCount.insertBefore(i.nCurr,i.nAll),c=0,s=a.length;s>c;c++){var t=i.create("tspan"),o=i.create(a[c],!0);i.attr(t,{x:0}),0==c?i.attr(t,{dy:i.pad}):i.attr(t,{dy:i.lineH}),t.appendChild(o),i.text.appendChild(t),i.nodes.push(t)}var u=i.text.getBBox(),r=i.tCount.getBBox(),l=i.tNext.getBBox(),f=i.tQuit.getBBox(),p=2*i.butW+r.width+2*i.pad;switch(u.width<p&&(u.width=p),n){case"top":h=e.left+i.pad,d=e.top-u.height-i.shif-i.pad-i.butH;break;case"left":h=e.left-u.width-i.shif-i.pad,d=e.top+i.pad;break;case"right":h=e.left+e.w+i.shif+i.pad,d=e.top+i.pad;break;default:h=e.left+i.pad,d=e.top+e.h+i.shif+i.pad}for(c=0;s>c;c++)i.attr(i.nodes[c],{x:h});i.attr(i.text,{x:h,y:d}).attr(i.wrap,{x:h-i.pad,y:d-i.pad,height:u.height+2*i.pad+i.butH,width:u.width+2*i.pad}).attr(i.bNext,{x:h+u.width+i.pad-i.butW,y:d+u.height+i.pad}).attr(i.tNext,{x:h+i.pad/2+Math.round(u.width-(i.butW+l.width)/2),y:d+u.height+2*i.pad+Math.round((i.butH-1.2*l.height)/2)}).attr(i.bQuit,{x:h,y:d+u.height+i.pad}).attr(i.tQuit,{x:h-i.pad/2+Math.round((i.butW-f.width)/2),y:d+u.height+2*i.pad+Math.round((i.butH-1.2*f.height)/2)}).attr(i.tCount,{x:h+Math.round((u.width-r.width)/2),y:d+u.height+i.pad+i.butH/2}).anim(i.hint,{attr:"opacity",to:1,dur:i.t})},i.t),i},next:function(t){var e=this;if("re"!=t||e.auto){if(!e.elements||!e.elements[e.active])return e.active>0&&e.quit(),e;t&&"re"!=t&&(e.auto=t),"function"==typeof e.elements[e.active].onActive&&e.elements[e.active].onActive(e.elements[e.active].element,e.active+1);var n=e.go(e.elements[e.active].element);return e.texter(e.elements[e.active].caption,n,e.elements[e.active].position).active++,e.auto&&setTimeout(function(){e.next("re")},e.auto),e}},stop:function(){var t=this;return t.auto=null,t},start:function(t,e){var n=this;return n.active=0,"object"==typeof e&&(n.auto=e.auto,n.onQuit=e.onQuit),n.elements=t.length?t:[t],n.inited||(n.canva=n.ID("tutorJS-svg"),n.hole=n.ID("tutorJS-hole"),n.bg=n.ID("tutorJS-bg"),n.text=n.ID("tutorJS-text"),n.wrap=n.ID("tutorJS-wrap"),n.bNext=n.ID("tutorJS-nextW"),n.bQuit=n.ID("tutorJS-quitW"),n.tNext=n.ID("tutorJS-nextT"),n.tQuit=n.ID("tutorJS-quitT"),n.tCount=n.ID("tutorJS-count"),n.hint=n.ID("tutorJS-hint"),n.on(n.ID("tutorJS-next"),"click",function(){n.next()}).on("mouseover",function(){n.attr(n.bNext,{fill:"url(#tutorJS-gradient5)"})}).on("mouseout",function(){n.attr(n.bNext,{fill:"url(#tutorJS-gradient3)"})}),n.on(n.ID("tutorJS-quit"),"click",function(){n.quit()}).on("mouseover",function(){n.attr(n.bQuit,{fill:"url(#tutorJS-gradient6)"})}).on("mouseout",function(){n.attr(n.bQuit,{fill:"url(#tutorJS-gradient4)"})}),n.inited=!0),n.nAll&&(n.tCount.removeChild(n.nAll),n.nAll=null),n.nAll=n.create("/"+n.elements.length,!0),n.tCount.appendChild(n.nAll),n.canva.style.display="block",n.anim(n.bg,{attr:"opacity",to:1,dur:3*n.t},function(){n.next()}),n},quit:function(){var t=this;return t.stop(),t.anim(t.hole,{attr:"opacity",to:0,dur:t.t}).anim(t.hint,{attr:"opacity",to:0,dur:t.t}).anim(t.bg,{attr:"opacity",to:0,dur:3*t.t},function(){t.canva.style.display="none",t.attr(t.hole,{width:0,height:0,x:0,y:0,opacity:1}),"function"==typeof t.onQuit&&t.onQuit(t)}),t}}}();